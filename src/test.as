package  
{
	import org.flixel.*;
	import org.flixel.plugin.photonstorm.*;
	/**
	 * ...
	 * @author Elijah Elefson
	 */
	public class test extends FlxState
	{
		[Embed(source = "image_assets/crayon_background.png")] private var background:Class;
		[Embed(source = "image_assets/crayon_dot.png")] private var dot:Class;
		[Embed(source = "image_assets/CrayonRed.png")] private var crayon:Class;
		
		public var level:FlxTilemap;
		public var player:FlxSprite;
		
		private var delay:FlxDelay
		private var a:Array;
		private var crayon_graphic:FlxExtendedSprite;
		override public function create():void {
			FlxG.bgColor = 0xffaaaaaa;
			a = new Array();
			a.push(new FlxPoint(0, 0));
			/*var data:Array = new Array(
				1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
				1, 1, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1,
				1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1,
				1, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1,
				1, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1,
				1, 0, 0, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1,
				1, 0, 0, 0, 1, 1, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1,
				1, 0, 0, 0, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 1,
				1, 1, 0, 0, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1,
				1, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1,
				1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1,
				1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1,
				1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 1,
				1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1,
				1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1,
				1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1,
				1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1,
				1, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1,
				1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 1,
				1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 1,
				1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 0, 0, 1,
				1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
				1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
				1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1,
				1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1,
				1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1,
				1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1,
				1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 1, 0, 1,
				1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 1,
				1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1 );
				/*var data:Array = new Array();
				for (var i:int = 0; i < 307200; i++) {
					data[i] = i;
				}*/
				/*level = new FlxTilemap();
				level.loadMap(FlxTilemap.arrayToCSV(data,40), background, 16, 16, FlxTilemap.OFF);
				add(level);*/
				
				/*var circle:FlxCircle = new FlxCircle(0, 0);
				add(FlxCircle);*/
				var dot:FlxSprite = new FlxSprite(0, 0, dot);
				add(dot);
				
				crayon_graphic = new FlxExtendedSprite(0, 0, crayon);
				crayon_graphic.enableMouseDrag();
				add(crayon_graphic);
				
				delay = new FlxDelay(1);
				delay.start();
		}
		
		override public function update():void {
			super.update();
			//var point:FlxPoint = FlxG.mouse.getScreenPosition();
			/*for (var j:int = 0; j < 20; j++) {
				for (var i:int = 0; i < 640; i++ ) {
					level.setTile(i, 0, 1);
				}
			}*/
			//level.setTile(0, 0, 0);
			/*if (FlxG.mouse.pressed()) {
				var point:FlxPoint = FlxG.mouse.getScreenPosition();
				if (a.length != 0) {
					var temp:FlxPoint = a.pop();
					var xDistance:Number = distanceBetweenPoints(new FlxPoint(point.x, point.y), new FlxPoint(temp.x, point.y)) / 40;
					var yDistance:Number = distanceBetweenPoints(new FlxPoint(point.x, point.y), new FlxPoint(point.x, temp.y)) / 40;
					for (var i:int = 0; i < 100; i++) {
						a.push(new FlxPoint(temp.x, temp.y));
						temp.x += xDistance;
						temp.y += yDistance;
					}
				}
				a.push(point);
				/*var point:FlxPoint = FlxG.mouse.getScreenPosition();
				level.setTile(level.getScreenXY(point), 0, 0);
				level.g*/
			//}
			
			//if (delay.hasExpired && a.length != 0) {
			/*if (delay.hasExpired && a.length != 0) {
				trace(a.length);
					var point2:FlxPoint = a.shift();
					var dot:FlxSprite = new FlxSprite(point2.x, point2.y, dot);
					add(dot);
					delay.reset(1);
			}*/
					//delay.reset(5);
			//}
			/*if (FlxG.mouse.pressed()) {
				var point:FlxPoint = FlxG.mouse.getScreenPosition();
				if (a.length != 0) {
					var temp:FlxPoint = a.pop();
					if (point.x >= temp.x + 16 && point.y >= temp.y + 16) {
						var xDistance:Number = distanceBetweenPoints(new FlxPoint(point.x, point.y), new FlxPoint(temp.x, point.y)) / 10;
						var yDistance:Number = distanceBetweenPoints(new FlxPoint(point.x, point.y), new FlxPoint(point.x, temp.y)) / 10;
						for (var i:int = 0; i < 10; i++) {
							a.push(new FlxPoint(temp.x, temp.y));
							trace("the fuck");
							temp.x += xDistance;
							temp.y += yDistance;
						}
					}
				}
				a.push(point);*/
				/*var point:FlxPoint = FlxG.mouse.getScreenPosition();
				level.setTile(level.getScreenXY(point), 0, 0);
				level.g*/
				
				//var point2:FlxPoint = a.shift();
				if (FlxG.mouse.pressed()) {
					var dot:FlxSprite = new FlxSprite(crayon_graphic.x, crayon_graphic.y, dot);
					add(dot);
				}
			//}
		}
		
		public function distanceBetweenPoints(P1:FlxPoint, P2:FlxPoint):Number {
			var dist:Number = FlxU.getDistance(P1, P2);
			if (P1.x >= P2.x) {
				dist *= -1;
			}
			if (P1.y >= P2.y) {
				dist *= -1;
			}
			return dist;
		}
		
	}

}